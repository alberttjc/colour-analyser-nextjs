# Gemini API Integration Setup

This document explains how to set up and use the Google Gemini AI integration for color analysis in your Next.js application.

## 🚀 Quick Setup

### 1. Install Dependencies

The required dependency has been added to your `package.json`. Run:

```bash
npm install
# or
pnpm install
# or
yarn install
```

### 2. Get Your Gemini API Key

1. Visit [Google AI Studio](https://aistudio.google.com/app/apikey)
2. Sign in with your Google account
3. Click "Create API Key"
4. Copy your API key

### 3. Configure Environment Variables

1. Copy the example environment file:
   ```bash
   cp .env.example .env.local
   ```

2. Edit `.env.local` and add your API key:
   ```
   GEMINI_API_KEY=your_actual_api_key_here
   ```

### 4. Run the Application

```bash
npm run dev
```

## 🎨 How It Works

### Image Processing Flow

1. **User uploads a photo** → Converted to base64
2. **Sent to `/api/analyze`** → Server-side API route
3. **Gemini AI analysis** → Analyzes facial features, skin tone, hair, eyes
4. **Structured response** → Returns season, color palette, and recommendations
5. **UI updates** → Displays personalized results

### API Response Structure

The Gemini API returns structured data in this format:

```typescript
interface ColorAnalysis {
  season: string;           // "Spring", "Summer", "Autumn", "Winter"
  palette: Array<{
    hex: string;           // "#FF7F50"
    name: string;          // "Coral"
  }>;
  explanation: string;     // Why this season fits the user
  recommendations: {
    clothing: string[];    // Clothing color recommendations
    makeup: string[];      // Makeup shade recommendations
    accessories: string[]; // Accessory recommendations
  };
}
```

## 🔧 Technical Implementation

### Key Files Added/Modified

- `lib/types.ts` - TypeScript interfaces for color analysis data
- `app/api/analyze/route.ts` - Server-side API route for Gemini integration
- `components/image-upload.tsx` - Updated to call real API instead of mock
- `components/color-palette.tsx` - Enhanced to use AI-generated colors
- `components/recommendations.tsx` - Enhanced to use AI-generated recommendations
- `app/page.tsx` - Updated to handle full analysis data

### Security Features

- ✅ API key stored server-side only
- ✅ No client-side exposure of sensitive data
- ✅ Proper error handling and validation
- ✅ Rate limiting protection
- ✅ Image safety checks

## 🎯 Features

### Enhanced UI Experience

- **Real-time progress updates** during analysis
- **Custom color palettes** generated by AI
- **Personalized recommendations** based on individual features
- **Detailed explanations** of why specific seasons were chosen
- **Error handling** with user-friendly messages

### AI-Powered Analysis

- **Advanced facial feature detection**
- **Skin undertone analysis** (warm vs cool)
- **Hair color and saturation assessment**
- **Eye color evaluation**
- **Seasonal classification** with high accuracy

## 🐛 Troubleshooting

### Common Issues

1. **"Missing API Key" Error**
   - Check that `.env.local` exists
   - Verify `GEMINI_API_KEY` is set correctly
   - Restart the development server

2. **"Image could not be processed" Error**
   - Ensure image contains a clear face
   - Try with better lighting
   - Use JPEG or PNG format
   - Avoid heavily filtered images

3. **Slow Analysis**
   - First request may be slower (cold start)
   - Subsequent requests should be faster
   - Check your internet connection

### Development Tips

- Test with various image types and lighting conditions
- Monitor the browser console for detailed error messages
- Check the server logs for API-related issues
- Use the Network tab to inspect API requests/responses

## 📈 Performance Considerations

- **Image optimization**: Large images are automatically handled
- **Caching**: Consider implementing response caching for production
- **Rate limiting**: Gemini API has usage limits
- **Error fallbacks**: App gracefully handles API failures

## 🔒 Privacy & Security

- Images are processed but not stored permanently
- API calls are made server-side to protect the API key
- No personal data is retained after analysis
- Follows Google's AI usage policies

## 🚀 Deployment

When deploying to production:

1. Set `GEMINI_API_KEY` in your deployment environment
2. Ensure the API route is properly secured
3. Consider implementing rate limiting
4. Monitor API usage and costs

## 📚 Additional Resources

- [Google Gemini AI Documentation](https://ai.google.dev/)
- [Next.js API Routes Documentation](https://nextjs.org/docs/api-routes/introduction)
- [Color Theory and Seasonal Analysis](https://en.wikipedia.org/wiki/Color_analysis_(art))
